function editor_tab_init(){return{text:"",pos:{left:0,top:0},selections:editor.listSelections()}}function editor_tab_close(tab){var id;if(typeof tab=="undefined"){tab=$("#tab_browsing_list li.selected")}id=tab.attr("data-id");if(id==$("#tab_browsing_list li.selected").attr("data-id")){editor_tab_select(tab.prev())}tab.remove();delete buffers[id];if($("#tab_browsing_list li").length==0){editor.setValue("");$("#editor").css("display","none")}return false}function editor_tab_select(tab){var id,si,old_tab=$("#tab_browsing_list li.selected"),old_id=old_tab.attr("data-id");id=tab.attr("data-id");if(old_id!=id&&buffers[id]){if(typeof old_id!=="undefined"){si=editor.getScrollInfo();buffers[old_id].text=editor.getValue();buffers[old_id].pos.left=si.left;buffers[old_id].pos.top=si.top;buffers[old_id].selections=editor.listSelections()}editor.setValue(buffers[id].text);editor.scrollTo(buffers[id].pos.left,buffers[id].pos.top);if(buffers[id].selections!==null){editor.setSelections(buffers[id].selections)}tab.addClass("selected");old_tab.removeClass("selected");editor.focus()}}function editor_tab_set_text(id,text){buffers[id].text=text;buffers[id].pos.left=0;buffers[id].pos.top=0;buffers[id].selections=null}function editor_tab_get_text(id){var cur_id=$("#tab_browsing_list li.selected").attr("data-id");if(parseInt(cur_id,10)==id){return editor.getValue()}else{return buffers[id].text}}function editor_tab_new(title,text,filename){var id=1,id_li,$tbl=$("#tab_browsing_list"),title_attr="";if(typeof title==="undefined"){title=""}if(typeof text==="undefined"){text=""}if(typeof filename==="undefined"){filename=""}else{title_attr=filename;filename=' data-filename="'+filename+'"'}$tbl.children().each(function(){if($(this).attr("data-id")){id_li=parseInt($(this).attr("data-id"),10);if(id_li>id)id=id_li}});if($tbl.children().length==0){id=1}else{id++}if(title==""){title=mydbr_loc.MYDBR_SQLEDIT_QUERY+" "+(id-1)}$tbl.append('<li title="'+title_attr+'" id="tab_file_query'+id+'" data-id="'+id+'"'+filename+'><div class="tab"><span>'+title+'<div class="close hidden"></div></span></div></li>');buffers[id]=editor_tab_init();editor_tab_select($tbl.children().last());editor.setValue(text)}